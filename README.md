# Passion Daily

ë§¤ì¼ ìƒˆë¡œìš´ ì˜ê°ì„ ì£¼ëŠ” ëª…ì–¸ ì•± - ê³ ì „ë¶€í„° í˜„ëŒ€ê¹Œì§€ì˜ ëª…ì–¸ìœ¼ë¡œ ë§¤ì¼ ìƒˆë¡œìš´ ì˜ê°ì„ ì œê³µí•˜ëŠ” ì• í”Œë¦¬ì¼€ì´ì…˜

## ğŸ“Œ í”„ë¡œì íŠ¸ ê°œìš”

### í•œ ì¤„ ìš”ì•½
ê³ ì „ë¶€í„° í˜„ëŒ€ê¹Œì§€ì˜ ëª…ì–¸ìœ¼ë¡œ ë§¤ì¼ ìƒˆë¡œìš´ ì˜ê°ì„ ì œê³µí•˜ëŠ” ì• í”Œë¦¬ì¼€ì´ì…˜

### ëª©ì 

"'ê·¸ ëª…ì–¸ ì–´ë””ì„ ê°€ ë´¤ë˜ ê²ƒ ê°™ì€ë°?' ê·¸ë¦¬ê³  'ì™œ ëª…ì–¸ ì•±ë“¤ì€ í•­ìƒ ì˜›ë‚  ì‚¬ëŒë“¤ ë§ë§Œ ëª¨ì•„ë†¨ì„ê¹Œ?'"

ì´ ë‘ ê°€ì§€ ê³ ë¯¼ì—ì„œ ì¶œë°œí–ˆìŠµë‹ˆë‹¤. í˜„ëŒ€ì¸ë“¤ì€ ë‹¤ì–‘í•œ ë¯¸ë””ì–´ì—ì„œ ì¢‹ì€ ëª…ì–¸ì„ ì ‘í•´ë„ ì–´ëŠìˆœê°„ ê¸°ì–µì—ì„œ ì‚¬ë¼ì§€ê³ , ê¸°ì¡´ ëª…ì–¸ ì•±ë“¤ì€ ì Šì€ ì„¸ëŒ€ì˜ ë‹ˆì¦ˆë¥¼ í¬ê²Œ ì¶©ì¡±ì‹œí‚¤ì§€ ëª»í•œë‹¤ëŠ” ì‚¬ì‹¤ì„ ì¸ì‹í•˜ì˜€ìŠµë‹ˆë‹¤. ë”°ë¼ì„œ ì‚¬ìš©ìê°€ ë§ˆìŒì— ë“œëŠ” ë¬¸êµ¬ë¥¼ ì‰½ê²Œ ì €ì¥í•˜ê³  ê³µìœ í•  ìˆ˜ ìˆê³ , ë‹¤ì–‘í•œ ì‹œëŒ€ì˜ ëª…ì–¸ì„ ì œê³µí•˜ëŠ” ëª…ì–¸ ì•±ì„ êµ¬ìƒí•˜ê³  ê°œë°œí•˜ê²Œ ë˜ì—ˆìŠµë‹ˆë‹¤.

### ê¸°ìˆ  ìŠ¤íƒ

- **ì‚¬ìš© ì–¸ì–´**: Kotlin
- **ì‚¬ìš© ê¸°ìˆ **: Jetpack Compose, Room, Firestore, Jetpack Navigation, Hilt, Compose UI Test, JUnit4
- **ê°œë°œ ê¸°ê°„**: 2024.11-2025.03
- **ì—­í• **: 1ì¸ ê°œë°œ

## ğŸ“± ìŠ¤í¬ë¦°ìƒ·

<p align="center">
  <img src="https://github.com/YoonseolLee/Passion-Daily-Photos/blob/main/KakaoTalk_20250306_165551598.jpg?raw=true" width="200"/>
  <img src="https://github.com/YoonseolLee/Passion-Daily-Photos/blob/main/KakaoTalk_20250306_165551598_01.jpg?raw=true" width="200"/>
</p>

## ğŸ“Š ë°ì´í„°ë² ì´ìŠ¤ êµ¬ì¡°

### Local DB (Room)
![image](https://github.com/user-attachments/assets/64621b07-3204-4e3c-8a1c-b9faced742d9)


### Remote DB (Firestore)
![image](https://github.com/user-attachments/assets/60522a32-d63a-445c-837b-1349c12cdc0e)


> **ğŸ’¡ Firestoreì—ì„œ ë³„ë„ì˜ quotesì™€ categories ì»¬ë ‰ì…˜ êµ¬ì¡° ëŒ€ì‹  ë‹¨ì¼ ì»¬ë ‰ì…˜ êµ¬ì¡°ë¥¼ ì„ íƒí–ˆìŠµë‹ˆë‹¤.**
> 
> **ì´ìœ **: ì¿¼ë¦¬ ì„±ëŠ¥ ìµœì í™” ë•Œë¬¸ì…ë‹ˆë‹¤. ì¹´í…Œê³ ë¦¬ë³„ ëª…ì–¸ ì¡°íšŒê°€ ì•±ì—ì„œ ê°€ì¥ ë¹ˆë²ˆí•œ ì‘ì—…ì´ë¯€ë¡œ, 2ê°œì˜ ì»¬ë ‰ì…˜ì— ëŒ€í•´ ì¿¼ë¦¬ë¥¼ ìƒì„±í•˜ëŠ” ê²ƒ ë³´ë‹¤ëŠ”, ë‹¨ì¼ ì¿¼ë¦¬ë§Œìœ¼ë¡œ 1ê°œì˜ ì»¬ë ‰ì…˜ì—ì„œ í•„ìš”í•œ ë°ì´í„°ë¥¼ ë¹ ë¥´ê²Œ ê°€ì ¸ì˜¬ ìˆ˜ ìˆë‹¤ê³  ìƒê°í–ˆìŠµë‹ˆë‹¤.

## ğŸ—ï¸ ì•„í‚¤í…ì²˜

### 1. MVVM íŒ¨í„´
Viewì™€ Modelì´ ì„œë¡œ ì „í˜€ ì•Œì§€ ëª»í•˜ë„ë¡ í•˜ì—¬ ë…ë¦½ì„±ì„ ë†’ì´ê³ , View ë¡œì§ê³¼ ë¹„ì§€ë‹ˆìŠ¤ ë¡œì§ì„ ë¶„ë¦¬í•˜ì—¬ ìƒì‚°ì„±ì„ ë†’ì˜€ìŠµë‹ˆë‹¤.

### 2. í´ë¦° ì•„í‚¤í…ì²˜
ì•ˆë“œë¡œì´ë“œ ê³µì‹ ë¬¸ì„œë¥¼ ê¸°ë°˜ìœ¼ë¡œ í´ë¦° ì•„í‚¤í…ì²˜ë¥¼ ë„ì…í•˜ì˜€ìŠµë‹ˆë‹¤. UI ë ˆì´ì–´, ë„ë©”ì¸ ë ˆì´ì–´, ë°ì´í„° ë ˆì´ì–´ë¡œ ê´€ì‹¬ì‚¬ë¥¼ ë¶„ë¦¬í•˜ì˜€ê³ , StateHolder, Coroutines, Flowë¥¼ ì ê·¹ì ìœ¼ë¡œ ì‚¬ìš©í•˜ì—¬ ìœ ì§€ë³´ìˆ˜ì™€ í…ŒìŠ¤íŠ¸ê°€ ìš©ì´í•œ êµ¬ì¡°ë¡œ ì„¤ê³„í•˜ì˜€ìŠµë‹ˆë‹¤.

### 3. SOLID ì›ì¹™
ê°ì²´ì§€í–¥ ì„¤ê³„ ì›ì¹™ì„ ì ìš©í•˜ì—¬ ì½”ë“œì˜ í™•ì¥ì„±ê³¼ ìœ ì§€ë³´ìˆ˜ì„±ì„ í–¥ìƒì‹œì¼°ìŠµë‹ˆë‹¤.

### 4. Hiltë¥¼ ì‚¬ìš©í•œ ì˜ì¡´ì„± ì£¼ì…
Hiltë¥¼ ì‚¬ìš©í•´ ì˜ì¡´ì„± ì£¼ì…ì„ ê°„í¸í•˜ê²Œ ì²˜ë¦¬í•˜ê³ , ê²°í•©ë„ë¥¼ ë‚®ì¶”ë©° ëª¨ë“ˆ ë‚´ ì‘ì§‘ë„ë¥¼ ë†’ì˜€ìŠµë‹ˆë‹¤.

## ğŸ§© SOLID ì›ì¹™ì„ ì ìš©í•œ í”„ë¡œì íŠ¸ êµ¬ì¡°

### 1. ë‹¨ì¼ ì±…ì„ ì›ì¹™ (Single Responsibility Principle)

```
com.example.passiondaily/
â”œâ”€â”€ quote/
â”‚   â”œâ”€â”€ data/ (ë°ì´í„° ê´€ë¦¬ ì±…ì„)
â”‚   â”‚   â”œâ”€â”€ repository/
â”‚   â”‚   â””â”€â”€ dao/
â”‚   â”œâ”€â”€ domain/ (ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ ì±…ì„)
â”‚   â”‚   â””â”€â”€ usecase/
â”‚   â””â”€â”€ presentation/ (UI í‘œì‹œ ì±…ì„)
â”‚       â”œâ”€â”€ screen/
â”‚       â””â”€â”€ viewmodel/
```

ê° í´ë˜ìŠ¤ì™€ ëª¨ë“ˆì€ í•˜ë‚˜ì˜ ì±…ì„ë§Œì„ ê°–ìŠµë‹ˆë‹¤. ì˜ˆë¥¼ ë“¤ì–´, QuoteDaoëŠ” ë°ì´í„° ì ‘ê·¼ë§Œ, QuoteViewModelì€ UI ìƒíƒœ ê´€ë¦¬ë§Œ ë‹´ë‹¹í•©ë‹ˆë‹¤.

### 2. ê°œë°©-íì‡„ ì›ì¹™ (Open-Closed Principle)

```
â”œâ”€â”€ manager/
â”‚   â”œâ”€â”€ QuoteLoadingManager (ì¸í„°í˜ì´ìŠ¤)
â”‚   â””â”€â”€ QuoteLoadingManagerImpl (êµ¬í˜„ì²´)
```

QuoteLoadingManager ì¸í„°í˜ì´ìŠ¤ë¥¼ í†µí•´ í™•ì¥ì—ëŠ” ì—´ë ¤ìˆê³ , ìˆ˜ì •ì—ëŠ” ë‹«í˜€ìˆëŠ” êµ¬ì¡°ì…ë‹ˆë‹¤.

### 3. ë¦¬ìŠ¤ì½”í”„ ì¹˜í™˜ ì›ì¹™ (Liskov Substitution Principle)

```
â”œâ”€â”€ favorites/
â”‚   â”œâ”€â”€ base/
â”‚   â”‚   â”œâ”€â”€ FavoritesViewModelActions
â”‚   â”œâ”€â”€ action/
â”‚   â”‚   â”œâ”€â”€ FavoritesLoadingActions 
â”‚   â”‚   â”œâ”€â”€ FavoritesModificationActions 
â”‚   â”‚   â””â”€â”€ FavoritesNavigationActions 
```

ë¶€ëª¨ í´ë˜ìŠ¤(ì¸í„°í˜ì´ìŠ¤)ë¥¼ ìì‹ í´ë˜ìŠ¤(êµ¬í˜„ì²´)ë¡œ ëŒ€ì²´í•´ë„ ì •ìƒì ìœ¼ë¡œ ë™ì‘í•´ì•¼ í•©ë‹ˆë‹¤. FavoritesViewModelActionsë¼ëŠ” ê¸°ë³¸ ì¸í„°í˜ì´ìŠ¤ë¥¼ ì—¬ëŸ¬ êµ¬í˜„ì²´ê°€ êµ¬í˜„í•˜ê³  ìˆìœ¼ë©°, ì´ë“¤ì€ ì„œë¡œ ëŒ€ì²´ ê°€ëŠ¥í•©ë‹ˆë‹¤.

### 4. ì¸í„°í˜ì´ìŠ¤ ë¶„ë¦¬ ì›ì¹™ (Interface Segregation Principle)

```
â”œâ”€â”€ action/
â”‚   â”œâ”€â”€ QuoteLoadingActions (ë¡œë”© ê¸°ëŠ¥ë§Œ í¬í•¨)
â”‚   â”œâ”€â”€ QuoteNavigationActions (íƒìƒ‰ ê¸°ëŠ¥ë§Œ í¬í•¨)
â”‚   â””â”€â”€ QuoteSharingActions (ê³µìœ  ê¸°ëŠ¥ë§Œ í¬í•¨)
```

ê¸°ëŠ¥ë³„ë¡œ ì¸í„°í˜ì´ìŠ¤ë¥¼ ë¶„ë¦¬í•˜ì˜€ìŠµë‹ˆë‹¤.

### 5. ì˜ì¡´ì„± ì—­ì „ ì›ì¹™ (Dependency Inversion Principle)

```kotlin
@Module
@InstallIn(SingletonComponent::class)
abstract class RepositoryModule {
    @Binds
    abstract fun bindLocalFavoriteRepository(repository: LocalFavoriteRepositoryImpl): 
    LocalFavoriteRepository
}
```

ê³ ìˆ˜ì¤€ ëª¨ë“ˆì´ ì €ìˆ˜ì¤€ ëª¨ë“ˆì— ì§ì ‘ ì˜ì¡´í•˜ì§€ ì•Šê³ , ì¶”ìƒí™”(ì¸í„°í˜ì´ìŠ¤)ì— ì˜ì¡´í•©ë‹ˆë‹¤.

## ğŸ” ì£¼ìš” ê¸°ëŠ¥

### 1. ëª…ì–¸ì„ ë¶ˆëŸ¬ì˜¤ëŠ” ê¸°ëŠ¥

```kotlin
override fun loadQuotes(category: QuoteCategory) {
    viewModelScope.launch {
        try {
            quoteStateHolder.updateIsQuoteLoading(true)

            val result = quoteLoadingManager.fetchQuotesByCategory(
                category = category,
                pageSize = PAGE_SIZE,
                lastLoadedQuote = lastLoadedQuote
            )

            if (result.quotes.isEmpty()) {
                quoteLoadingManager.setHasQuoteReachedEndTrue()
                return@launch
            }

            if (quotes.value.isEmpty()) {
                lastLoadedQuote = result.lastDocument
                quoteLoadingManager.addQuotesToState(result.quotes, true)
            } else {
                lastLoadedQuote = result.lastDocument
                quoteLoadingManager.addQuotesToState(result.quotes, false)
            }
        } catch (e: Exception) {
            handleError(e)
        } finally {
            quoteStateHolder.updateIsQuoteLoading(false)
        }
    }
}
```

#### 1.1 ì½”ë£¨í‹´ì„ í™œìš©í•œ ë¹„ë™ê¸° ì²˜ë¦¬

> **ğŸ’¡ Firestoreì—ì„œ ëª…ì–¸ì„ ë¶ˆëŸ¬ì˜¬ ë•Œ Dispatchers.IOë¥¼ ì‚¬ìš©í•˜ì˜€ìŠµë‹ˆë‹¤.**
> 
> **ì´ìœ **: Dispatchers.IOëŠ” Firestore ê°™ì€ I/O ì‘ì—…ì— ìµœì í™”ëœ ìŠ¤ë ˆë“œ í’€ì„ ì œê³µí•˜ê¸° ë•Œë¬¸ì…ë‹ˆë‹¤.

#### 1.2 ì˜¤ë¥˜ ì²˜ë¦¬ ë° ì¬ì‹œë„ ë©”ì»¤ë‹ˆì¦˜

> **ğŸ’¡ ìµœëŒ€ 3íšŒê¹Œì§€ ìë™ ì¬ì‹œë„ ë° 10ì´ˆ íƒ€ì„ì•„ì›ƒì„ ì ìš©í•˜ì˜€ìŠµë‹ˆë‹¤.**
> 
> **ì´ìœ **: ê³¼ë„í•œ ì„œë²„ ë¶€í•˜ë¥¼ ë°©ì§€í•˜ê³ , ëª¨ë°”ì¼ í™˜ê²½ì—ì„œ ì¼ë°˜ì ì¸ ë°ì´í„° ìš”ì²­ì€ 1-3ì´ˆ ë‚´ë¡œ ì™„ë£Œë˜ê¸° ë•Œë¬¸ì— 10ì´ˆê°€ ì´ˆê³¼ë˜ë©´ ë„¤íŠ¸ì›Œí¬ ë¬¸ì œë¡œ ê°„ì£¼í•˜ê¸° ìœ„í•¨ì…ë‹ˆë‹¤.

#### 1.3 í˜ì´ì§€ë„¤ì´ì…˜ êµ¬í˜„

> **ğŸ’¡ í˜ì´ì§€ ì‚¬ì´ì¦ˆë¥¼ 10ìœ¼ë¡œ ì„¤ì •í•˜ì˜€ìŠµë‹ˆë‹¤.**
> 
> **ì´ìœ **: ì „ì²´ ëª…ì–¸ ì»¬ë ‰ì…˜ì˜ í‰ê·  í¬ê¸°ì¸ ì•½ 20ê°œì˜ ì ˆë°˜ìœ¼ë¡œ ì„¤ì •í–ˆìŠµë‹ˆë‹¤. ëª…ì–¸ ì•±ì˜ íŠ¹ì„±ìƒ ì‚¬ìš©ìê°€ ì‡¼ì¸  ì½˜í…ì¸ ì²˜ëŸ¼ ì—°ì†ì ìœ¼ë¡œ ì†Œë¹„í•˜ëŠ” íŒ¨í„´ì„ ê³ ë ¤í•˜ì—¬ ì¶©ë¶„í•œ ì–‘ì„ ë¯¸ë¦¬ ë¡œë“œí•˜ë„ë¡ ì„¤ê³„í–ˆìŠµë‹ˆë‹¤.

### 2. ì¦ê²¨ì°¾ê¸°ì— ì¶”ê°€í•˜ëŠ” ê¸°ëŠ¥

```kotlin
class SaveFavoritesToLocalUseCase @Inject constructor(
    private val localFavoriteRepository: LocalFavoriteRepository,
    private val localQuoteRepository: LocalQuoteRepository,
    private val localQuoteCategoryRepository: LocalQuoteCategoryRepository
) {

    suspend fun saveToLocalDatabase(
        selectedCategory: QuoteCategory,
        currentQuote: Quote
    ) {
        ensureCategoryExists(selectedCategory)
        ensureQuoteExists(selectedCategory, currentQuote)
        saveFavorite(currentQuote.id, selectedCategory)
    }

    private suspend fun ensureCategoryExists(category: QuoteCategory) {
        if (!localQuoteCategoryRepository.isCategoryExists(category.ordinal)) {
            val categoryEntity = QuoteCategoryEntity(
                categoryId = category.ordinal,
                categoryName = category.getLowercaseCategoryId()
            )
            localQuoteCategoryRepository.insertCategory(categoryEntity)
        }
    }

    private suspend fun ensureQuoteExists(
        category: QuoteCategory,
        quote: Quote
    ) {
        if (!localQuoteRepository.isQuoteExistsInCategory(quote.id, category.ordinal)) {
            val quoteEntity = QuoteEntity(
                quoteId = quote.id,
                text = quote.text,
                person = quote.person,
                imageUrl = quote.imageUrl,
                categoryId = category.ordinal
            )
            localQuoteRepository.insertQuote(quoteEntity)
        }
    }

    private suspend fun saveFavorite(
        quoteId: String,
        category: QuoteCategory
    ) {
        val favoriteEntity = FavoriteEntity(
            quoteId = quoteId,
            categoryId = category.ordinal
        )
        localFavoriteRepository.insertFavorite(favoriteEntity)
    }
}
```

#### 2.1 ì¦ê²¨ì°¾ê¸° ì¶”ê°€ ì „ ì‚¬ì „ ê²€ì¦

> **ğŸ’¡ ì¦ê²¨ì°¾ê¸° ì €ì¥ ì „ ì¹´í…Œê³ ë¦¬ì™€ ëª…ì–¸ì˜ ì¡´ì¬ ì—¬ë¶€ë¥¼ í™•ì¸í•˜ë„ë¡ êµ¬í˜„í–ˆìŠµë‹ˆë‹¤.**
> 
> **ì´ìœ **: DBì˜ ì°¸ì¡° ë¬´ê²°ì„±ì„ ë³´ì¥í•˜ê¸° ìœ„í•¨ì…ë‹ˆë‹¤. ensureCategoryExistsì™€ ensureQuoteExists í•¨ìˆ˜ë¥¼ í†µí•´ ì¦ê²¨ì°¾ê¸° ì¶”ê°€ ì´ì „ì— ì‚¬ì „ ê²€ì¦ì„ ìˆ˜í–‰í•©ë‹ˆë‹¤.

#### 2.2 Room DAOì—ì„œ Flow ë°˜í™˜

> **ğŸ’¡ Room DAOì—ì„œ Flowë¥¼ ë°˜í™˜í•˜ëŠ” íŒ¨í„´ì„ ì ìš©í–ˆìŠµë‹ˆë‹¤.**
> 
> **ì´ìœ **: ë°ì´í„°ë² ì´ìŠ¤ ë³€ê²½ì‚¬í•­ì„ UIì— ìë™ ë°˜ì˜í•˜ë©´ì„œë„ ë©”ëª¨ë¦¬ íš¨ìœ¨ì„±ì„ ë†’ì´ê¸° ìœ„í•¨ì…ë‹ˆë‹¤. Flowì˜ cold stream íŠ¹ì„±ì„ í†µí•´ í•„ìš” ì‹œì ì—ë§Œ ë°ì´í„°ë¥¼ ì²˜ë¦¬í•  ìˆ˜ ìˆë„ë¡ í•˜ê¸° ìœ„í•¨ì…ë‹ˆë‹¤.

### 3. ì¦ê²¨ì°¾ê¸°ë¥¼ ê°€ì ¸ì˜¤ëŠ” ê¸°ëŠ¥

```kotlin
override fun loadFavorites() {
    favoritesJob?.cancel()
    favoritesJob = viewModelScope.launch {
        favoritesLoadingManager.updateIsFavoriteLoading(true)
        try {
            favoritesLoadingManager.getAllFavorites()
                .catch { e ->
                    favoritesLoadingManager.updateIsFavoriteLoading(false)
                    favoritesStateHolder.updateIsFavoriteLoading(false)
                    throw e
                }
                .collect { favorites ->
                    handleFavoritesUpdate(favorites)
                    favoritesLoadingManager.updateIsFavoriteLoading(false)
                }
        } catch (e: Exception) {
            favoritesLoadingManager.updateIsFavoriteLoading(false)
            handleError(e)
        }
    }
}

private fun handleFavoritesUpdate(favorites: List<QuoteEntity>) {
    favoritesLoadingManager.updateFavoriteQuotes(favorites)
    if (_currentQuoteIndex.value >= favorites.size) {
        savedStateHandle[KEY_FAVORITE_INDEX] = 0
    }
}
```

#### 3.1 ì¤‘ë³µ ìš”ì²­ ë°©ì§€ë¥¼ ìœ„í•œ ì½”ë£¨í‹´ Job ê´€ë¦¬

> **ğŸ’¡ ì¦ê²¨ì°¾ê¸° ë¡œë”© ì‹œ ì´ì „ ì‘ì—…ì„ ì·¨ì†Œí•˜ë„ë¡ êµ¬í˜„í–ˆìŠµë‹ˆë‹¤.**
> 
> **ì´ìœ **: ë§Œì•½ ì‚¬ìš©ìê°€ ì¦ê²¨ì°¾ê¸° í™”ë©´ì„ ë¹ ë¥´ê²Œ ì—¬ëŸ¬ ë²ˆ ì „í™˜í•˜ê±°ë‚˜, ëª©ë¡ì„ ìì£¼ ìƒˆë¡œê³ ì¹¨í•œë‹¤ë©´ ì—¬ëŸ¬ ê°œì˜ ë°ì´í„° ë¡œë”© ì‘ì—…ì´ ë™ì‹œì— ì‹œì‘ë  ê°€ëŠ¥ì„±ì´ ì¡´ì¬í•©ë‹ˆë‹¤. loadFavorites() í˜¸ì¶œ ì‹œ FavoritesJob?.cancel()ë¡œ ì´ì „ ë°ì´í„° ë¡œë”©ì„ ì·¨ì†Œí•¨ìœ¼ë¡œì¨ loadFavorites()ê°€ ì¤‘ë³µë˜ê²Œ í˜¸ì¶œë˜ëŠ” ìƒí™©ì„ ë°©ì§€í•˜ê¸° ìœ„í•¨ì…ë‹ˆë‹¤.

#### 3.2 SavedStateHandleì„ í™œìš©í•œ ìƒíƒœ ë³´ì¡´

> **ğŸ’¡ ì¦ê²¨ì°¾ê¸° ëª©ë¡ì˜ ì¸ë±ìŠ¤ë¥¼ SavedStateHandleë¡œ ê´€ë¦¬í•˜ì˜€ìŠµë‹ˆë‹¤.**
> 
> **ì´ìœ **: í™”ë©´ íšŒì „ì´ë‚˜ í”„ë¡œì„¸ìŠ¤ ì¬ìƒì„± ì‹œì—ë„ ì‚¬ìš©ìê°€ ë§ˆì§€ë§‰ìœ¼ë¡œ ë³¸ ëª…ì–¸ ì¸ë±ìŠ¤ë¥¼ ìœ ì§€í•˜ê¸° ìœ„í•¨ì…ë‹ˆë‹¤. ë˜í•œ ì˜ˆì™¸ ìƒí™©ìœ¼ë¡œ ì¸í•´ ëª©ë¡ í¬ê¸°ê°€ ë³€ê²½ë˜ë©´, ì¸ë±ìŠ¤ë¥¼ ìë™ìœ¼ë¡œ ì¡°ì •í•˜ì—¬ í•­ìƒ ìœ íš¨í•œ ë°ì´í„°ë¥¼ í‘œì‹œí•˜ë„ë¡ í•˜ì˜€ìŠµë‹ˆë‹¤.

## ğŸš€ ì„±ëŠ¥ ìµœì í™”

### Flow êµ¬ë… ìµœì í™”

```kotlin
// ìµœì í™” ì „
override val currentQuote: StateFlow<Quote?> =
    combine(quotes, _currentQuoteIndex) { quotes, index ->
        quotes.getOrNull(index)
    }.stateIn(viewModelScope, SharingStarted.Lazily, null)

// ìµœì í™” í›„
override val currentQuote: StateFlow<Quote?> =
    combine(quotes, _currentQuoteIndex) { quotes, index ->
        quotes.getOrNull(index)
    }.stateIn(viewModelScope, SharingStarted.WhileSubscribed(5000), null)
```

**ë¬¸ì œì **:
QuoteViewModelì—ì„œ `SharingStarted.Lazily` ì „ëµì„ ì‚¬ìš©í•˜ì—¬ í™”ë©´ì„ ë²—ì–´ë‚˜ë„ Flowê°€ ê³„ì† í™œì„± ìƒíƒœë¡œ ìœ ì§€ë˜ì—ˆìŠµë‹ˆë‹¤.

**ì›ì¸**:
`SharingStarted.Lazily`ëŠ” ì²« ë²ˆì§¸ êµ¬ë…ìê°€ ë‚˜íƒ€ë‚œ í›„ ê³„ì† í™œì„± ìƒíƒœë¥¼ ìœ ì§€í•˜ë¯€ë¡œ í™”ë©´ì„ ë²—ì–´ë‚˜ë„ ë¶ˆí•„ìš”í•œ ë¦¬ì†ŒìŠ¤ë¥¼ ì†Œë¹„í•˜ê¸° ë•Œë¬¸ì…ë‹ˆë‹¤.

**í•´ê²°ë°©ì•ˆ**:
`SharingStarted.WhileSubscribed(5000)`ìœ¼ë¡œ ë³€ê²½í•˜ì—¬ ë§ˆì§€ë§‰ êµ¬ë…ìê°€ ì‚¬ë¼ì§„ í›„ 5ì´ˆ ë’¤ì— ìë™ìœ¼ë¡œ Flowë¥¼ ì·¨ì†Œí•˜ë„ë¡ í•˜ì˜€ìŠµë‹ˆë‹¤. 5ì´ˆì˜ íƒ€ì„ì•„ì›ƒì„ ì„¤ì •í•œ ì´ìœ ëŠ” ì¼ë°˜ì ì¸ ëª…ì–¸ ì•±ì˜ ì‚¬ìš©ìê°€ 5ì´ˆ ì•ˆì— ëŒì•„ì˜¤ì§€ ì•Šìœ¼ë©´ ë‹¤ë¥¸ í™œë™ìœ¼ë¡œ ì „í™˜í–ˆì„ ê°€ëŠ¥ì„±ì´ í¬ê¸° ë•Œë¬¸ì…ë‹ˆë‹¤.

### ì• ë‹ˆë©”ì´ì…˜ ìµœì í™”

```kotlin
// ìµœì í™” ì „
AnimatedContent(
    targetState = currentQuote,
    transitionSpec = {
        (slideIntoContainer(slideDirection, animationSpec = ContentAnimationSpec) +
                fadeIn(animationSpec = FadeAnimationSpec)).togetherWith(
            slideOutOfContainer(slideDirection, animationSpec = ContentAnimationSpec) +
                    fadeOut(animationSpec = FadeAnimationSpec)
        )
    }
) { quote ->
    quote?.let {
        QuoteAndPerson(
            quote = it.text,
            author = it.person
        )
    }
}

// ìµœì í™” í›„
val currentQuoteId = remember {
    derivedStateOf {
        currentQuote?.id ?: ""
    }
}.value

AnimatedContent(
    targetState = currentQuoteId,
    transitionSpec = {
        (slideIntoContainer(
            slideDirection,
            animationSpec = ContentAnimationSpec
        ) +
                fadeIn(animationSpec = FadeAnimationSpec)).togetherWith(
            slideOutOfContainer(
                slideDirection,
                animationSpec = ContentAnimationSpec
            ) +
                    fadeOut(animationSpec = FadeAnimationSpec)
        )
    }
) { quoteId ->
    val displayedQuote = remember(quoteId, quotes) {
        quotes.find { it.id == quoteId } ?: currentQuote
    }

    key(displayedQuote?.id) {
        displayedQuote?.let {
            QuoteAndPerson(
                quote = it.text,
                author = it.person
            )
        }
    }
}
```

**ë¬¸ì œì **:
`AnimatedContent`ê°€ ì „ì²´ `currentQuote` ê°ì²´ë¥¼ íƒ€ê²Ÿìœ¼ë¡œ ì‚¬ìš©í•˜ì—¬ ë¶ˆí•„ìš”í•œ ë¦¬ì»´í¬ì§€ì…˜ê³¼ ì• ë‹ˆë©”ì´ì…˜ì´ ë°œìƒí•˜ì—¬ ì„±ëŠ¥ì— ì•…ì˜í–¥ì„ ì¤ë‹ˆë‹¤.

**ì›ì¸**: 
Quote ê°ì²´ë¥¼ targetStateë¡œ ì„¤ì •í•˜ë©´, ê°ì²´ì˜ ì–´ë–¤ ì†ì„±ì´ ë³€ê²½ë˜ë”ë¼ë„ ì „ì²´ ì»´í¬ì§€ì…˜ì´ ë‹¤ì‹œ ë°œìƒí•˜ê³  ì• ë‹ˆë©”ì´ì…˜ì´ íŠ¸ë¦¬ê±°ë©ë‹ˆë‹¤. ê°ì²´ ë‚´ìš©ì´ ë™ì¼í•˜ê³  ì°¸ì¡°ë§Œ ë³€ê²½ëœ ê²½ìš°ì—ë„ ë¶ˆí•„ìš”í•œ ì• ë‹ˆë©”ì´ì…˜ì„ ë°œìƒì‹œí‚µë‹ˆë‹¤.

**í•´ê²°ë°©ì•ˆ**:
1. derivedStateOfë¥¼ ì‚¬ìš©í•˜ì—¬ currentQuoteì—ì„œ IDë§Œ ì¶”ì¶œí•˜ë„ë¡ í•˜ì˜€ìŠµë‹ˆë‹¤. quote ê°ì²´ì˜ ë‹¤ë¥¸ ì†ì„±ì´ ë³€ê²½ë˜ì–´ë„ IDê°€ ë™ì¼í•˜ë©´ ì• ë‹ˆë©”ì´ì…˜ì´ íŠ¸ë¦¬ê±°ë˜ì§€ ì•ŠìŠµë‹ˆë‹¤.
2. targetStateë¡œ quoteIdë¥¼ ì‚¬ìš©í•˜ì—¬ í•„ìš”í•œ ê²½ìš°ì—ë§Œ ì• ë‹ˆë©”ì´ì…˜ì´ ë°œìƒí•˜ë„ë¡ í•˜ì˜€ìŠµë‹ˆë‹¤.
3. `remember`ë¥¼ ì‚¬ìš©í•´ quoteIdì™€ quotesê°€ ë³€ê²½ë  ë•Œë§Œ displayedQuoteë¥¼ ë‹¤ì‹œ ê³„ì‚°í•˜ë„ë¡ í•˜ì˜€ìŠµë‹ˆë‹¤.
4. keyë¥¼ ì‚¬ìš©í•˜ì—¬ quoteIdê°€ ë³€ê²½ë  ë•Œì—ë§Œ ë‚´ë¶€ ì»´í¬ë„ŒíŠ¸ë¥¼ ë‹¤ì‹œ êµ¬ì„±í•˜ë„ë¡ í•˜ì˜€ìŠµë‹ˆë‹¤.

### ì„±ëŠ¥ ìµœì í™” ê²°ê³¼

ì• í”Œë¦¬ì¼€ì´ì…˜ ì„±ëŠ¥ ìµœì í™” ì‘ì—…ì˜ ê²°ê³¼, **ì‚¬ìš©ì CPU ì‹œê°„ì´ ì•½ 2.4% ê°ì†Œ**í•˜ì˜€ìœ¼ë©° **ì• ë‹ˆë©”ì´ì…˜ FPSê°€ ìµœëŒ€ 9.3% í–¥ìƒ**ë˜ì—ˆìŠµë‹ˆë‹¤.

#### 1. CPU ì‚¬ìš©ëŸ‰ ë¹„êµ í…ŒìŠ¤íŠ¸

| í•­ëª© | ê°œì„  ì „ | ê°œì„  í›„ | ë³€í™”ìœ¨ |
| --- | --- | --- | --- |
| ì‚¬ìš©ì CPU ì‹œê°„ (ì‹œê°„ë‹¹) | 14ë¶„ 44ì´ˆ | 14ë¶„ 22ì´ˆ | -2.4% |
| ì‹¤ì œ ì¸¡ì • ì‚¬ìš©ì CPU ì‹œê°„ | 48.957ì´ˆ | 47.719ì´ˆ | -2.5% |

#### 2. FPS í…ŒìŠ¤íŠ¸ ë¹„êµ í…ŒìŠ¤íŠ¸

| ì§€í‘œ | ìˆ˜ì • ì „ | ìˆ˜ì • í›„ | ê°œì„  ê²°ê³¼ |
| --- | --- | --- | --- |
| ê¸°ë³¸ FPS ì•ˆì •ì„± | 59.73-60.13 | 59.90-60.01 | **ê°œì„ ë¨** (ë” ì¼ê´€ëœ ê°’) |
| ìµœëŒ€ FPS | 101.87 | 111.35 | **ê°œì„ ë¨** (+9.3%) |
| ì• ë‹ˆë©”ì´ì…˜ ì¤‘ í‰ê·  FPS | ì•½ 73.14 | ì•½ 78.64 | **ê°œì„ ë¨** (+7.5%) |
| ìœ íœ´ ìƒíƒœ FPS ë³€ë™ | Â±0.15 | Â±0.05 | **ê°œì„ ë¨** (3ë°° ë” ì•ˆì •ì ) |

## ğŸ§ª í…ŒìŠ¤íŠ¸

### UI í…ŒìŠ¤íŠ¸

```kotlin
@RunWith(AndroidJUnit4::class)
class CategoryScreenTest {
    private val mainCoroutineRule = MainCoroutineRule()
    private val composeTestRule = createComposeRule()

    @get:Rule
    val ruleChain: RuleChain = RuleChain
        .outerRule(mainCoroutineRule)
        .around(composeTestRule)

    private val quoteViewModel = mockk<QuoteViewModel>(relaxed = true)
    private val quoteStateHolder = mockk<QuoteStateHolder>(relaxed = true)

    @Before
    fun setup() {
        every { quoteStateHolder.categories } returns MutableStateFlow(
            QuoteCategory.values().map { it.koreanName }
        )
        every { quoteStateHolder.selectedQuoteCategory } returns MutableStateFlow(QuoteCategory.EFFORT)
    }

    @Test
    fun ì¹´í…Œê³ ë¦¬_í™”ë©´ì´_ì˜¬ë°”ë¥´ê²Œ_í‘œì‹œëœë‹¤() = mainCoroutineRule.runTest {
        // When
        composeTestRule.setContent {
            CategoryScreen(
                quoteViewModel = quoteViewModel,
                quoteStateHolder = quoteStateHolder,
                onNavigateToQuote = {},
                onBack = {}
            )
        }

        // Then
        composeTestRule.waitForIdle()

        composeTestRule
            .onNodeWithText("ì¹´í…Œê³ ë¦¬")
            .assertExists()
            .assertIsDisplayed()

        composeTestRule
            .onNode(hasText("ì˜¤ëŠ˜ì€ ì–´ë–¤ ì£¼ì œì˜ ëª…ì–¸ì„ ë§Œë‚˜ë³¼ê¹Œìš”?"))
            .assertExists()
            .assertIsDisplayed()
    }
}
```

Compose UI í…ŒìŠ¤íŠ¸ í”„ë ˆì„ì›Œí¬ë¥¼ ì‚¬ìš©í•˜ì—¬ UI í…ŒìŠ¤íŠ¸ ì½”ë“œë¥¼ ì‘ì„±í–ˆìŠµë‹ˆë‹¤. `createComposeRule()`ì„ í†µí•´ Compose ì»´í¬ë„ŒíŠ¸ë¥¼ ë…ë¦½ì ìœ¼ë¡œ í…ŒìŠ¤íŠ¸í•˜ê³ , MockKë¥¼ ì‚¬ìš©í•˜ì—¬ ViewModelê³¼ StateHolderë¥¼ ëª¨í‚¹í•˜ì—¬ í…ŒìŠ¤íŠ¸ ì½”ë“œë¥¼ ì‘ì„±í–ˆìŠµë‹ˆë‹¤.

### ë‹¨ìœ„ í…ŒìŠ¤íŠ¸

```kotlin
@OptIn(ExperimentalCoroutinesApi::class)
class IncrementShareCountUseCaseTest {
    @get:Rule
    val mainCoroutineRule = MainCoroutineRule()

    private lateinit var useCase: IncrementShareCountUseCase
    private lateinit var remoteQuoteRepository: RemoteQuoteRepository

    @Before
    fun setup() {
        remoteQuoteRepository = mockk {
            coEvery { incrementShareCount(any(), any()) } returns Unit
        }
        useCase = IncrementShareCountUseCase(remoteQuoteRepository)
    }

    @Test
    fun `ê³µìœ  íšŸìˆ˜ë¥¼ ì¦ê°€ì‹œí‚¬ ë•Œ repositoryë¥¼ í˜¸ì¶œí•œë‹¤`() = mainCoroutineRule.runTest {
        // given
        val quoteId = "test_quote_id"
        val category = QuoteCategory.LOVE

        // when
        useCase.incrementShareCount(quoteId, category)
        advanceUntilIdle()

        // then
        coVerify { remoteQuoteRepository.incrementShareCount(quoteId, category) }
    }
}
```

ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ì„ ê²€ì¦í•˜ê¸° ìœ„í•´ JUnitê³¼ MockKë¥¼ ì‚¬ìš©í•œ ë‹¨ìœ„ í…ŒìŠ¤íŠ¸ë¥¼ êµ¬í˜„í–ˆìŠµë‹ˆë‹¤.

### í†µí•© í…ŒìŠ¤íŠ¸

ë‹¤ì–‘í•œ í•˜ë“œì›¨ì–´ í™˜ê²½ì—ì„œì˜ ì•± ì„±ëŠ¥ê³¼ ì•ˆì •ì„±ì„ ê²€ì¦í•˜ê¸° ìœ„í•´ ì„¸ ê·¸ë£¹ìœ¼ë¡œ ë‚˜ëˆ„ì–´ í†µí•© í…ŒìŠ¤íŠ¸ë¥¼ ì§„í–‰í–ˆìŠµë‹ˆë‹¤.

- **ê·¸ë£¹ 1 (ê³ ì‚¬ì–‘)**: AVDë¥¼ í†µí•´ ìµœì‹  í•˜ë“œì›¨ì–´ ìŠ¤í™ì—ì„œì˜ ë™ì‘ ê²€ì¦
- **ê·¸ë£¹ 2 (ì¤‘ì‚¬ì–‘)**: ì‹¤ì œ ë¬¼ë¦¬ì  ê¸°ê¸°ë¥¼ ì‚¬ìš©í•˜ì—¬ ì‹¤ì œ ì‚¬ìš© í™˜ê²½ì—ì„œì˜ ì‚¬ìš©ì ê²½í—˜ ê²€ì¦
- **ê·¸ë£¹ 3 (ì €ì‚¬ì–‘)**: ì œí•œëœ ë¦¬ì†ŒìŠ¤ í™˜ê²½ì—ì„œì˜ ì„±ëŠ¥ê³¼ ì•ˆì •ì„± ê²€ì¦ì„ ìœ„í•œ AVD í…ŒìŠ¤íŠ¸

ì‹¤ì œ í…ŒìŠ¤íŠ¸ ê²°ê³¼ëŠ” [Passion-Daily-í†µí•©í…ŒìŠ¤íŠ¸](https://docs.google.com/spreadsheets/d/17egLQB4Slzd_o4PIL5EtBCU0fKos96ydCCDpNHdRMiw/edit?usp=sharing)ì—ì„œ í™•ì¸í•˜ì‹¤ ìˆ˜ ìˆìŠµë‹ˆë‹¤.
